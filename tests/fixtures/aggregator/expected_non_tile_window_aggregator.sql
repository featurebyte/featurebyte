SELECT
  POINT_IN_TIME,
  cust_id,
  "T0"."_fb_internal_CUSTOMER_ID_non_tile_window_sum_a_cust_id_None_W172800_43200_1800_900_0_input_1" AS "_fb_internal_CUSTOMER_ID_non_tile_window_sum_a_cust_id_None_W172800_43200_1800_900_0_input_1"
FROM REQUEST_TABLE
LEFT JOIN (
  SELECT
    "POINT_IN_TIME" AS "POINT_IN_TIME",
    "CUSTOMER_ID" AS "CUSTOMER_ID",
    SUM("a") AS "_fb_internal_CUSTOMER_ID_non_tile_window_sum_a_cust_id_None_W172800_43200_1800_900_0_input_1"
  FROM (
    SELECT
      REQ."POINT_IN_TIME",
      REQ."CUSTOMER_ID",
      VIEW."a"
    FROM "REQUEST_TABLE_NO_TILE_W172800_F43200_BS900_M1800_CUSTOMER_ID" AS REQ
    INNER JOIN "VIEW_859473829e4a3d63" AS VIEW
      ON FLOOR(REQ."__FB_WINDOW_END_EPOCH" / 172800) = FLOOR(VIEW."__FB_VIEW_TIMESTAMP_EPOCH" / 172800)
      AND REQ."CUSTOMER_ID" = VIEW."cust_id"
    WHERE
      VIEW."__FB_VIEW_TIMESTAMP_EPOCH" >= REQ."__FB_WINDOW_START_EPOCH"
      AND VIEW."__FB_VIEW_TIMESTAMP_EPOCH" < REQ."__FB_WINDOW_END_EPOCH"
    UNION ALL
    SELECT
      REQ."POINT_IN_TIME",
      REQ."CUSTOMER_ID",
      VIEW."a"
    FROM "REQUEST_TABLE_NO_TILE_W172800_F43200_BS900_M1800_CUSTOMER_ID" AS REQ
    INNER JOIN "VIEW_859473829e4a3d63" AS VIEW
      ON FLOOR(REQ."__FB_WINDOW_END_EPOCH" / 172800) - 1 = FLOOR(VIEW."__FB_VIEW_TIMESTAMP_EPOCH" / 172800)
      AND REQ."CUSTOMER_ID" = VIEW."cust_id"
    WHERE
      VIEW."__FB_VIEW_TIMESTAMP_EPOCH" >= REQ."__FB_WINDOW_START_EPOCH"
      AND VIEW."__FB_VIEW_TIMESTAMP_EPOCH" < REQ."__FB_WINDOW_END_EPOCH"
  )
  GROUP BY
    "POINT_IN_TIME",
    "CUSTOMER_ID"
) AS T0
  ON REQ."POINT_IN_TIME" = T0."POINT_IN_TIME" AND REQ."CUSTOMER_ID" = T0."CUSTOMER_ID"
