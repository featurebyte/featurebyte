# Generated by SDK version: {sdk_version}
from bson import ObjectId
from featurebyte import ColumnCleaningOperation
from featurebyte import EventTable
from featurebyte import MissingValueImputation

event_table = EventTable.get_by_id(ObjectId("{table_id}"))
event_view = event_table.get_view(
    view_mode="manual",
    drop_column_names=["created_at"],
    column_cleaning_operations=[
        ColumnCleaningOperation(
            column_name="col_float",
            cleaning_operations=[MissingValueImputation(imputed_value=0)],
        ),
        ColumnCleaningOperation(
            column_name="cust_id",
            cleaning_operations=[MissingValueImputation(imputed_value=-999)],
        ),
    ],
)
grouped = event_view.groupby(by_keys=["cust_id"], category=None).aggregate_over(
    value_column="col_float",
    method="sum",
    windows=["1d"],
    feature_names=["sum_1d"],
    feature_job_setting={{
        "blind_spot": "2700s",
        "frequency": "1800s",
        "time_modulo_frequency": "900s",
    }},
    skip_fill_na=True,
)
feat = grouped["sum_1d"]
output = feat
